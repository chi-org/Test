name: Workflow For PoC

on: 
  push: 
    branches:
    - main
  workflow_dispatch:

jobs:
  job1:
    runs-on: ubuntu-dind
    permissions:
      contents: read
      packages: write
    outputs: 
      output_var: ${{ steps.output_var.outputs.output_var }}
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    - name: Output var step
      id: output_var
      run: |
        echo "output_var=test" >> $GITHUB_OUTPUT
        exit 1;

  job2:
    runs-on: ubuntu-dind
    needs: job1
    if: always() && !cancelled()
    steps:
    - name: Use output vars step
      if: failure()
      run: |
        echo "Output var from job1: ${{ needs.job1.outputs.output_var }}"
        echo "this job will run if job1 fails"
    - name: Echo test
      run: |
        echo "This is a test step"
